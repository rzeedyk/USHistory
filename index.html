<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>American Revolution Adventure</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2 {
            color: #005a9c;
        }
        button {
            background-color: #005a9c;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #003a6c;
        }
        #resource-display, #skills-display, #relationships-display {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        #mini-game-container {
            border: 2px solid #005a9c;
            padding: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>American Revolution Adventure</h1>
        
        <div id="resource-display">
            <p>Troops: <span id="troop-count">100</span> | 
               Supplies: <span id="supply-count">100</span> | 
               Funding: <span id="funding-count">100</span></p>
        </div>
        
        <div id="skills-display">
            <p>Diplomacy: <span id="diplomacy-skill">1</span> | 
               Military: <span id="military-skill">1</span> | 
               Espionage: <span id="espionage-skill">1</span></p>
        </div>

        <div id="relationships-display">
            <p>Washington: <span id="washington-relation">0</span> | 
               Franklin: <span id="franklin-relation">0</span> | 
               Jefferson: <span id="jefferson-relation">0</span></p>
        </div>

        <section id="start">
            <h2>Welcome to the American Revolution</h2>
            <p>You are about to embark on a journey through one of the most pivotal periods in American history. Your choices will shape the course of events. Are you ready to make history?</p>
            <button id="start-journey">Start your journey</button>
        </section>

        <section id="character_creation" style="display:none;">
            <h2>Create Your Character</h2>
            <p>Before you begin your adventure, choose your background:</p>
            <button id="choose-merchant">Merchant (Bonus: Funding)</button>
            <button id="choose-soldier">Former Soldier (Bonus: Troops)</button>
            <button id="choose-politician">Local Politician (Bonus: Diplomacy)</button>
        </section>

        <section id="boston_tea_party" style="display:none;">
            <h2>The Boston Tea Party</h2>
            <p>It's December 16, 1773. You find yourself in Boston Harbor, where tensions are high due to unfair taxation. A group of colonists are planning to dump British tea into the harbor as a form of protest.</p>
            <p>What do you choose to do?</p>
            <button id="join-tea-party">Join the Tea Party</button>
            <button id="warn-british">Warn the British</button>
            <button id="observe-secretly">Observe secretly and report to newspaper</button>
        </section>

        <section id="colonial_congress" style="display:none;">
            <h2>First Continental Congress</h2>
            <p>September 1774: Colonial leaders gather to discuss a unified response to British actions. Your reputation from the Tea Party incident precedes you.</p>
            <p>How will you contribute?</p>
            <button id="advocate-peace">Advocate for peaceful resolution</button>
            <button id="push-for-independence">Push for independence</button>
            <button id="propose-boycott">Propose a boycott of British goods</button>
        </section>

        <section id="paul_revere_ride" style="display:none;">
            <h2>Paul Revere's Midnight Ride</h2>
            <p>It's April 18, 1775. British troops are on the move, and you've got to warn Samuel Adams and John Hancock. You're basically the colonial version of a group text!</p>
            <p>How will you spread the word?</p>
            <button id="ride-horse">Ride your horse through town</button>
            <button id="use-lanterns">Use lantern signals from the church</button>
            <button id="send-messengers">Send multiple messengers on foot</button>
        </section>

        <section id="lexington_concord" style="display:none;">
            <h2>The Battles of Lexington and Concord</h2>
            <p>It's April 19, 1775. The British have arrived, and the first shots of the revolution are about to be fired. The air is thick with tension, like a colonial Twitter feed about to explode.</p>
            <p>What role will you play in this pivotal moment?</p>
            <button id="join-minutemen">Join the Minutemen</button>
            <button id="negotiate-peace">Attempt to negotiate peace</button>
            <button id="protect-civilians">Help evacuate civilians</button>
        </section>

        <section id="declaration_independence" style="display:none;">
            <h2>The Declaration of Independence</h2>
            <p>It's the summer of 1776 in Philadelphia. The Continental Congress is meeting, and there's more drama than a season finale of "Stranger Things." You're part of the committee tasked with drafting the Declaration of Independence.</p>
            <p>How will you contribute to this historic document?</p>
            <button id="emphasize-liberty">Emphasize "Life, Liberty, and the pursuit of Happiness"</button>
            <button id="focus-grievances">Focus on listing grievances against the King</button>
            <button id="propose-equality">Propose that "all men are created equal"</button>
        </section>

        <section id="battle_trenton" style="display:none;">
            <h2>The Battle of Trenton</h2>
            <p>It's December 25, 1776. General Washington has a daring plan to cross the Delaware River and surprise the Hessian forces in Trenton. It's so cold, you feel like you're in an episode of "Game of Thrones" - winter is definitely coming!</p>
            <p>What role will you take in this pivotal battle?</p>
            <button id="lead-troops">Lead a group of troops across the river</button>
            <button id="spy-mission">Go on a spy mission to gather intelligence</button>
            <button id="assist-crossing">Help manage the logistics of crossing the river</button>
        </section>

        <section id="valley_forge" style="display:none;">
            <h2>Valley Forge</h2>
            <p>It's the winter of 1777-1778, and you're at Valley Forge with Washington's army. The conditions are brutal - it's colder than a White Walker's handshake, and supplies are scarcer than toilet paper in a pandemic.</p>
            <p>How will you help the army survive this harsh winter?</p>
            <button id="improve-shelter">Work on improving shelters and sanitation</button>
            <button id="forage-food">Organize foraging parties to find food</button>
            <button id="boost-morale">Boost morale through training and activities</button>
        </section>

        <section id="french_alliance" style="display:none;">
            <h2>Securing French Alliance</h2>
            <p>It's 1778, and you've been sent to France to secure their support. Benjamin Franklin is already there, charming the French court with his wit and inventions.</p>
            <p>How will you contribute to the diplomatic efforts?</p>
            <button id="host-dinner">Host a lavish dinner for French nobles</button>
            <button id="appeal-to-king">Make a direct appeal to King Louis XVI</button>
            <button id="work-with-franklin">Collaborate closely with Franklin</button>
        </section>

        <section id="battle_strategy" style="display:none;">
    <h2>Battle Strategy Mini-Game</h2>
    <p>General Washington needs your help to plan the next battle. Use your resources wisely!</p>
    <div id="battle-strategy-container"></div>
</section>

<section id="spy_network" style="display:none;">
    <h2>Building a Spy Network</h2>
    <p>The British have spies everywhere. It's time to build our own network to gather crucial intelligence.</p>
    <div id="spy-network-container"></div>
</section>

        <section id="game_end" style="display:none;">
            <h2>The Birth of a Nation</h2>
            <p>Congratulations! You've made it through the American Revolution. Your choices have shaped the course of history.</p>
            <p>Final Score: <span id="final-score"></span></p>
            <p id="end-message"></p>
            <button id="play-again">Play Again</button>
        </section>
    </div>

    <script>
        let playerScore = 0;
        let resources = {
            troops: 100,
            supplies: 100,
            funding: 100
        };
        let skills = {
            diplomacy: 1,
            military: 1,
            espionage: 1
        };
        let relationships = {
            washington: 0,
            franklin: 0,
            jefferson: 0
        };
        let playerBackground = '';

        function updateResources(troopChange, supplyChange, fundingChange) {
            resources.troops = Math.max(0, resources.troops + troopChange);
            resources.supplies = Math.max(0, resources.supplies + supplyChange);
            resources.funding = Math.max(0, resources.funding + fundingChange);
            
            document.getElementById('troop-count').textContent = resources.troops;
            document.getElementById('supply-count').textContent = resources.supplies;
            document.getElementById('funding-count').textContent = resources.funding;
        }

        function updateSkills(diplomacyChange, militaryChange, espionageChange) {
            skills.diplomacy = Math.max(1, skills.diplomacy + diplomacyChange);
            skills.military = Math.max(1, skills.military + militaryChange);
            skills.espionage = Math.max(1, skills.espionage + espionageChange);
            
            document.getElementById('diplomacy-skill').textContent = skills.diplomacy;
            document.getElementById('military-skill').textContent = skills.military;
            document.getElementById('espionage-skill').textContent = skills.espionage;
        }

        function updateRelationships(washingtonChange, franklinChange, jeffersonChange) {
            relationships.washington += washingtonChange;
            relationships.franklin += franklinChange;
            relationships.jefferson += jeffersonChange;
            
            document.getElementById('washington-relation').textContent = relationships.washington;
            document.getElementById('franklin-relation').textContent = relationships.franklin;
            document.getElementById('jefferson-relation').textContent = relationships.jefferson;
        }

        function choosePath(path) {
            console.log("choosePath called with path:", path);
            
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
            });
            
            const pathActions = {
                'start_journey': { nextPath: 'character_creation', score: 0, resources: [0, 0, 0], skills: [0, 0, 0] },
                'choose_merchant': { nextPath: 'boston_tea_party', score: 0, resources: [0, 0, 50], skills: [1, 0, 0], message: "Your merchant background provides extra funding and diplomatic connections." },
                'choose_soldier': { nextPath: 'boston_tea_party', score: 0, resources: [50, 0, 0], skills: [0, 1, 0], message: "Your military experience grants you additional troops and tactical knowledge." },
                'choose_politician': { nextPath: 'boston_tea_party', score: 0, resources: [0, 0, 25], skills: [2, 0, 0], message: "Your political background enhances your diplomatic skills and provides some additional funding." },
                'join_tea_party': { nextPath: 'colonial_congress', score: 5, resources: [-10, 0, -20], skills: [0, 1, 0], message: "You've taken a bold stand against British taxation!", 
                                    condition: () => resources.troops >= 10 && resources.funding >= 20 },
                'warn_british': { nextPath: 'colonial_congress', score: -3, resources: [0, 0, 10], skills: [1, 0, 0], message: "Your loyalist actions may have consequences..." },
                'observe_secretly': { nextPath: 'colonial_congress', score: 2, resources: [0, 0, 5], skills: [0, 0, 1], message: "You've documented an important historical event!" },
                'advocate_peace': { nextPath: 'paul_revere_ride', score: 2, resources: [10, 10, 10], skills: [1, 0, 0], message: "Your peaceful approach gains support from moderates." },
                'push_for_independence': { nextPath: 'paul_revere_ride', score: 5, resources: [-10, -10, -10], skills: [0, 1, 0], message: "Your bold stance rallies patriots but depletes resources." },
                'propose_boycott': { nextPath: 'paul_revere_ride', score: 3, resources: [0, -20, 20], skills: [1, 0, 1], message: "The boycott strains supplies but increases funding and support." },
                'ride_horse': { nextPath: 'lexington_concord', score: 5, resources: [-5, -5, 0], skills: [0, 1, 0], message: "Your midnight ride warns the colonists, but at a cost to your resources." },
                'use_lanterns': { nextPath: 'lexington_concord', score: 4, resources: [0, -5, -5], skills: [0, 0, 1], message: "The lantern signal effectively warns the colonists while preserving some resources." },
                'send_messengers': { nextPath: 'lexington_concord', score: 3, resources: [-10, 0, -10], skills: [1, 0, 0], message: "Your network of messengers spreads the word, but it's costly." },
                'join_minutemen': { nextPath: 'declaration_independence', score: 5, resources: [-20, -10, 0], skills: [0, 2, 0], message: "You've joined the fight, gaining valuable military experience!" },
                'negotiate_peace': { nextPath: 'declaration_independence', score: 2, resources: [0, 0, -10], skills: [2, 0, 0], message: "Your attempt at peace was noble, but war seems inevitable." },
                'protect_civilians': { nextPath: 'declaration_independence', score: 4, resources: [-5, -10, 0], skills: [1, 1, 0], message: "You've saved lives and shown true heroism!" },
                'emphasize_liberty': { nextPath: 'battle_trenton', score: 5, resources: [0, 0, -10], skills: [1, 0, 0], message: "Your words will echo through history!" },
                'focus_grievances': { nextPath: 'battle_trenton', score: 3, resources: [10, 0, -5], skills: [0, 1, 0], message: "You've made a strong case against British rule." },
                'propose_equality': { nextPath: 'battle_trenton', score: 4, resources: [-5, 0, -5], skills: [2, 0, 0], message: "Your ideals will shape the new nation's future." },
                'lead_troops': { nextPath: 'valley_forge', score: 5, resources: [-20, -10, 0], skills: [0, 2, 0], message: "Your leadership inspires the troops to victory!" },
                'spy_mission': { nextPath: 'valley_forge', score: 4, resources: [-5, -5, -10], skills: [0, 0, 2], message: "Your intel proves crucial to the battle's success." },
                'assist_crossing': { nextPath: 'valley_forge', score: 3, resources: [-10, -15, -5], skills: [1, 1, 0], message: "Your organizational skills ensure a smooth operation." },
                'improve_shelter': { nextPath: 'french_alliance', score: 4, resources: [-10, -20, -10], skills: [1, 1, 0], message: "You've significantly improved living conditions at Valley Forge." },
                'forage_food': { nextPath: 'french_alliance', score: 3, resources: [-5, 20, -5], skills: [0, 1, 1], message: "Your efforts have helped stave off hunger in the camp." },
                'boost_morale': { nextPath: 'french_alliance', score: 5, resources: [-5, -10, -5], skills: [2, 1, 0], message: "The troops' spirits are high thanks to your initiatives!" },
                'host_dinner': { nextPath: 'battle_strategy', score: 3, resources: [0, -10, -20], skills: [1, 0, 0], relationships: [0, 1, 0], 
                                 message: "Your dinner impresses the French nobles, but it's costly." },
                'appeal_to_king': { nextPath: 'battle_strategy', score: 5, resources: [0, 0, -10], skills: [2, 0, 0], relationships: [0, 0, 1], 
                                    message: "King Louis XVI is receptive to your appeal!" },
                'work_with_franklin': { nextPath: 'battle_strategy', score: 4, resources: [0, -5, -5], skills: [1, 0, 1], relationships: [0, 2, 0], 
                                        message: "You and Franklin make a great team, securing French support." }
            };
            
            if (pathActions[path]) {
                const action = pathActions[path];
                if (action.condition && !action.condition()) {
                    alert("You don't have enough resources for this action!");
                    return;
                }
                playerScore += action.score;
                updateResources(...action.resources);
                updateSkills(...action.skills);
                if (action.relationships) {
                    updateRelationships(...action.relationships);
                }
                if (action.message) {
                    alert(action.message + "\nYour current score: " + playerScore);
                }
                const targetSection = document.getElementById(action.nextPath);
                if (targetSection) {
                    targetSection.style.display = 'block';
                    if (action.nextPath === 'battle_strategy') {
                        initBattleStrategy();
                    } else if (action.nextPath === 'spy_network') {
                        initSpyNetwork();
                    } else if (action.nextPath === 'game_end') {
                        endGame();
                    }
                } else {
                    console.error("Could not find section with id:", action.nextPath);
                }
            }
        }

        function initBattleStrategy() {
    const container = document.getElementById('battle-strategy-container');
    container.innerHTML = `
        <div id="battlefield" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 10px;"></div>
        <button id="start-battle">Start Battle</button>
        <p id="battle-result"></p>
    `;

    const battlefield = document.getElementById('battlefield');
    for (let i = 0; i < 9; i++) {
        const region = document.createElement('div');
        region.style.border = '1px solid black';
        region.style.height = '50px';
        region.style.display = 'flex';
        region.style.justifyContent = 'center';
        region.style.alignItems = 'center';
        region.dataset.troops = '0';
        region.textContent = '0';
        region.onclick = () => placeTroops(region);
        battlefield.appendChild(region);
    }

    document.getElementById('start-battle').onclick = conductBattle;
}

function placeTroops(region) {
    if (resources.troops > 0) {
        resources.troops--;
        region.dataset.troops = parseInt(region.dataset.troops) + 1;
        region.textContent = region.dataset.troops;
        updateResources(0, 0, 0);
    }
}

function conductBattle() {
    let playerScore = 0;
    let enemyScore = 0;
    const regions = document.querySelectorAll('#battlefield div');
    
    regions.forEach(region => {
        const playerTroops = parseInt(region.dataset.troops);
        const enemyTroops = Math.floor(Math.random() * 5);
        if (playerTroops > enemyTroops) {
            playerScore++;
        } else if (enemyTroops > playerTroops) {
            enemyScore++;
        }
    });

    const resultElement = document.getElementById('battle-result');
    if (playerScore > enemyScore) {
        resultElement.textContent = "Victory! Your strategy was successful.";
        playerScore += 5;
        updateSkills(0, 1, 0);
        updateRelationships(2, 0, 0);
    } else {
        resultElement.textContent = "Defeat. The enemy outmaneuvered us.";
        updateRelationships(-1, 0, 0);
    }

    setTimeout(() => {
        document.getElementById('battle_strategy').style.display = 'none';
        document.getElementById('spy_network').style.display = 'block';
        initSpyNetwork();
    }, 2000);
}

        function allocateResources(type) {
    const amount = Math.min(resources[type], 50);
    resources[type] -= amount;
    updateResources(0, 0, 0); // This will update the display
    const success = Math.random() < (amount / 100 + skills.military / 10);
    const resultElement = document.getElementById('battle-result');
    if (success) {
        resultElement.textContent = "Victory! Your strategy was successful.";
        playerScore += 5;
        updateSkills(0, 1, 0);
        updateRelationships(2, 0, 0);
    } else {
        resultElement.textContent = "Defeat. Your strategy didn't work out this time.";
        updateRelationships(-1, 0, 0);
    }
    setTimeout(() => {
        document.getElementById('battle_strategy').style.display = 'none';
        document.getElementById('spy_network').style.display = 'block';
        initSpyNetwork();
    }, 2000);
}

        function initSpyNetwork() {
    const container = document.getElementById('spy-network-container');
    container.innerHTML = `
        <p>Choose your spying method:</p>
        <button onclick="conductEspionage('bribe')">Bribe Officials (Cost: 20 Funding)</button>
        <button onclick="conductEspionage('infiltrate')">Infiltrate Enemy Ranks (Cost: 10 Troops)</button>
        <button onclick="conductEspionage('codebreak')">Intercept and Decode Messages (No cost)</button>
        <p id="espionage-result"></p>
    `;
}

        function conductEspionage(method) {
            let success = false;
            const resultElement = document.getElementById('espionage-result');
            switch(method) {
                case 'bribe':
                    if (resources.funding >= 20) {
                        resources.funding -= 20;
                        success = Math.random() < (0.6 + skills.espionage / 20);
                    } else {
                        resultElement.textContent = "Not enough funding!";
                        return;
                    }
                    break;
                case 'infiltrate':
                    if (resources.troops >= 10) {
                        resources.troops -= 10;
                        success = Math.random() < (0.5 + skills.military / 20);
                    } else {
                        resultElement.textContent = "Not enough troops!";
                        return;
                    }
                    break;
                case 'codebreak':
                    success = Math.random() < (0.4 + skills.espionage / 10);
                    break;
            }
            updateResources(0, 0, 0); // Update display
            if (success) {
                resultElement.textContent = "Success! You've gathered valuable intelligence.";
                playerScore += 5;
                updateSkills(0, 0, 1);
                updateRelationships(1, 0, 0);
            } else {
                resultElement.textContent = "Your espionage attempt failed, but you gained experience.";
                updateSkills(0, 0, 1);
            }
            setTimeout(() => {
                document.getElementById('spy_network').style.display = 'none';
                endGame();
                document.getElementById('game_end').style.display = 'block';
            }, 2000);
        }

        function endGame() {
            document.getElementById('final-score').textContent = playerScore;
            let endMessage = "";
            if (playerScore >= 50) {
                endMessage = "Incredible! You're a true founding father of the nation!";
            } else if (playerScore >= 40) {
                endMessage = "Well done! Your actions have significantly shaped the revolution!";
            } else if (playerScore >= 30) {
                endMessage = "Good job! You've made a positive impact on the revolutionary cause.";
            } else {
                endMessage = "You've survived the revolution, but your impact was limited.";
            }
            endMessage += `\n\nFinal Relationships:\nWashington: ${relationships.washington}\nFranklin: ${relationships.franklin}\nJefferson: ${relationships.jefferson}`;
            document.getElementById('end-message').textContent = endMessage;
        }

        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    const path = this.id.replace(/-/g, '_');
                    console.log("Button clicked, path:", path);
                    if (path === 'play_again') {
                        location.reload();
                    } else {
                        choosePath(path);
                    }
                });
            });
        });
    </script>
</body>
</html>
